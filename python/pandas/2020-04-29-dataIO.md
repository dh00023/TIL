# 데이터 입출력

## 데이터 가져오기

### 외부 파일 읽어오기
Pandas는 다양한 형태의 외부 파일을 읽어와 DataFrame으로 변환하는 함수를 제공한다. 어떠한 파일이든 DataFrame으로 변환하면 Pandas의 모든 함수와 기능을 자유롭게 사용할 수 있다.

| File Format     | Reader         | Writer       |
| --------------- | -------------- | ------------ |
| CSV             | read_csv       | to_csv       |
| JSON            | read_json      | to_json      |
| HTML            | read_html      | to_html      |
| Local clipboard | read_clipboard | to_clipboard |
| MS Excel        | read_excel     | to_excel     |
| HDF5 Format     | read_hdf       | to_hdf       |
| SQL             | read_sql       | to_sql       |

#### CSV

CSV(Comma-Separated Values)는 데이터 값을 쉼표(`,`)로 구분하고 있다는 의미의 텍스트 파일이다. 쉼표로 열을 구분하고 줄바꿈으로 행을 구분하고 있다.

```python
pandas.read_csv(file)
```

| 옵션              | 설명                                                         |
| ----------------- | ------------------------------------------------------------ |
| path              | 파일의 위치(파일명 포함), URL                                |
| sep(or delimiter) | 텍스트 데이터를 필드별로 구분하는 문자                       |
| header            | 열 이름으로 사용될 행의 번호( default = 0)<br/>header가 없고 첫 행부터 데이터가 있는 경우 None으로 지정가능 |
| index_col         | 행 인덱스로 사용할 열의 번호 또는 열 이름                    |
| names             | 열 이름으로 사용할 문자열의 리스트                           |
| skiprows          | 처음 몇 줄을 skip할 것인지 설정<br/>skip하려는 행의 번호를 담은 리스트로 설정 가능(`[1,3,5]`) |
| parse_dates       | 날짜 텍스트를 datetime64로 변환할 것인지 설정(default=False) |
| skip_footer       | 마지막 몇 줄을 skip할 것인지 설정                            |
| encoding          | 텍스트 인코딩 종류를 지정                                    |

```python
>>> import pandas as pd
>>> file_path = './qna.csv'
>>> df = pd.read_csv(file_path,  encoding='ms949')
>>> print(df)
       ITEM_CD  ...                                           CONTENTS
0     62938619  ...  88사이즈 밖에 없는데 99사이즈도 입어도 되나요 많이 넉넉하게 나왔나요  선물 할...
1     62491750  ...                                       다음방송은 언제인가요?
2     62006040  ...  44사이즈도 만들어 주세요\n바지는  정말~~~~예쁘고 입고 싶은 스탈인데 55사이...
```

#### Excel

```python
pandas.read_excel(file)
```

read_excel()은 앞의 `read_csv()` 와 거의 유사하다. 대부분의 옵션을 그대로 사용할 수 있다.

```python
>>> df = pd.read_excel('./django.xlsx', header=1)
>>> print(df)
                                     Django 프로젝트 간트차트                              Unnamed: 1 Unnamed: 2  ... Unnamed: 72    Unnamed: 73 Unnamed: 74
0                                           작성자 : 정다혜                                     NaN        NaN  ...         NaN            NaN         NaN
1                             작성일 : 2019년 11월 22일 (금)                                     NaN        NaN  ...         NaN            NaN         NaN
2                                                 NaN                                     NaN        NaN  ...         NaN            NaN         NaN
3                                                 NaN                                   작업 이름         기간  ...         NaN  2019년 11월 24일         NaN
4                                                 NaN                                     NaN        NaN  ...        23.0             24        25.0
5                                                   1                                    사전공부       21 일  ...         NaN            NaN         NaN
6                                                   2                      Django + python 공부       11 일  ...         NaN            NaN         NaN
7                                                   3                  Vue.js + javascirpt 공부        6 일  ...         NaN            NaN         NaN
```

- ImportError

```
>>> df = pd.read_excel('./django.xlsx')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/Users/jeongdaye/.pyenv/versions/pandas/lib/python3.7/site-packages/pandas/io/excel/_base.py", line 304, in read_excel
    io = ExcelFile(io, engine=engine)
  File "/Users/jeongdaye/.pyenv/versions/pandas/lib/python3.7/site-packages/pandas/io/excel/_base.py", line 824, in __init__
    self._reader = self._engines[engine](self._io)
  File "/Users/jeongdaye/.pyenv/versions/pandas/lib/python3.7/site-packages/pandas/io/excel/_xlrd.py", line 20, in __init__
    import_optional_dependency("xlrd", extra=err_msg)
  File "/Users/jeongdaye/.pyenv/versions/pandas/lib/python3.7/site-packages/pandas/compat/_optional.py", line 92, in import_optional_dependency
    raise ImportError(msg) from None
ImportError: Missing optional dependency 'xlrd'. Install xlrd >= 1.0.0 for Excel support Use pip or conda to install xlrd.
```

excel파일을 읽어오려고 할때 다음과 같은 오류가 발생할 수 있다. 이 경우에는 해당 라이브러리를 설치해주면된다.

```bash
$ pip install xlrd
```



#### JSON

JSON 파일은 데이터 공유를 목적으로 개발된 특수한 파일 형식이다.

```python
pandas.read_json(file)
```

```python
>>> df = pd.read_json('./itemInfo.json')
>>> print(df)
                  code        serialID resCode resMsg                                             result  description  status  errorCode message
benefitInfo          1  20200429114333                   {'noInterestMonth': 10, 'isFreeDelivery': True}          NaN     200        NaN
cateInfo             1  20200429114333                 {'llargeCategoryId': 'G00007', 'llargeCategory...          NaN     200        NaN
channelCode          1  20200429114333                                                          50001001          NaN     200        NaN
detailInfo           1  20200429114333                 {'itemType': 'CJMALL', 'slPrc': 188000, 'clpSl...          NaN     200        NaN
exceptionCode        1  20200429114333                                                                00          NaN     200        NaN
exceptionMsg         1  20200429114333                                                                정상          NaN     200        NaN
imagesInfo           1  20200429114333                 {'timeStamp': 1567555709718, 'itemImages': ['/...          NaN     200        NaN
itemButton           1  20200429114333                 {'giftDeliv': False, 'type': 'BUY', 'cart': Fa...          NaN     200        NaN
marketingBanners     1  20200429114333                                                                []          NaN     200        NaN
mobilePlus           1  20200429114333                                                                 0          NaN     200        NaN
shareEventInfo       1  20200429114333                                                              None          NaN     200        NaN
videoInfo            1  20200429114333                 {'internetLive': None, 'broadcastItemType': 'E...          NaN     200        NaN
```

### Web에서 가져오기

#### HTML 웹 페이지에서 속성 가져오기

```python
pandas.read_html(url or htmlfile)
```

`read_html()` 메소드는 HTML에 있는 `<table>` 태그에서 표 형식의 데이터를 모두 찾아서 DataFrame으로 변환한다.



## 참고

- [파이썬 머신러닝 판다스 데이터 분석](http://digital.kyobobook.co.kr/digital/ebook/ebookDetail.ink?LINK=NVE&category=001&barcode=4808956748337)
- [pandas API](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_excel.html)
